{"ast":null,"code":"var _jsxFileName = \"/Users/dariabrusnitsina/Yandex.Disk.localized/Programming/Projects/react-e-commerce/client/src/components/shopPages/shopPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { paginate } from \"../../utils/paginate\";\nimport api from \"../../api\";\nimport _ from \"lodash\";\nimport ItemCard from \"./itemCard\";\nimport Pagination from \"./pagination\";\nimport CategoriesList from \"./categoriesList\";\nimport SortButton from \"./sortButton\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getItems } from \"../../store/items\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ShopPage = () => {\n  _s();\n  const dispatch = useDispatch();\n  const [currentPage, setCurrentPage] = useState(1);\n  const [categories, setCategories] = useState();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedCategory, setSelectedCategory] = useState();\n  const [sortBy, setSortBy] = useState(\"asc\");\n  const pageSize = 6;\n  const [items, setItems] = useState();\n  useEffect(() => {\n    dispatch(loadItemsList());\n  }, []);\n  const itemsData = useSelector(getItems());\n  console.log(itemsData);\n  useEffect(() => {\n    api.items.fetchAll().then(data => setItems(data));\n  }, []);\n  useEffect(() => {\n    api.categories.fetchAll().then(data => setCategories(data));\n  }, []);\n  useEffect(() => {\n    setCurrentPage(1);\n  }, [selectedCategory, searchQuery]);\n  const handleCategorySelect = item => {\n    if (searchQuery !== \"\") setSearchQuery(\"\");\n    setSelectedCategory(item);\n  };\n  const handleSearchQuery = _ref => {\n    let {\n      target\n    } = _ref;\n    setSelectedCategory(undefined);\n    setSearchQuery(target.value);\n  };\n  const handlePageChange = pageIndex => {\n    setCurrentPage(pageIndex);\n  };\n  const handleSort = item => {\n    setSortBy(item);\n  };\n  if (items) {\n    const filteredItems = searchQuery ? items.filter(item => item.name.toLowerCase().indexOf(searchQuery.toLowerCase()) !== -1) : selectedCategory ? items.filter(item => JSON.stringify(item.category.name) === JSON.stringify(selectedCategory.name)) : items;\n    const count = filteredItems.length;\n    const sortedUsers = _.orderBy(filteredItems, ['price'], sortBy);\n    const usersCrop = paginate(sortedUsers, currentPage, pageSize);\n    const clearFilter = () => {\n      setSelectedCategory();\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"shop__section\",\n      children: [categories && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"shop__categories\",\n          children: [/*#__PURE__*/_jsxDEV(CategoriesList, {\n            selectedItem: selectedCategory,\n            items: categories,\n            onItemSelect: handleCategorySelect\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"reset-categories-btn\",\n            onClick: clearFilter,\n            children: [\" \", \"reset filter\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"shop__items\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"shop__items--bar\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"search-input\",\n            type: \"text\",\n            name: \"searchQuery\",\n            placeholder: \"Search...\",\n            onChange: handleSearchQuery,\n            value: searchQuery\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(SortButton, {\n            onSort: handleSort,\n            selectedSort: sortBy\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"shop__items--list\",\n          children: count > 0 && usersCrop.map(item => /*#__PURE__*/_jsxDEV(ItemCard, {\n            item: item,\n            width: 270\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex justify-content-center\",\n          children: /*#__PURE__*/_jsxDEV(Pagination, {\n            itemsCount: count,\n            pageSize: pageSize,\n            currentPage: currentPage,\n            onPageChange: handlePageChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"p\", {\n    className: \"loading\",\n    children: \"loading...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 140,\n    columnNumber: 12\n  }, this);\n};\n_s(ShopPage, \"yrfSKrPmljf/Bc2m7PWbfkQTK58=\", false, function () {\n  return [useDispatch, useSelector];\n});\n_c = ShopPage;\nexport default ShopPage;\nvar _c;\n$RefreshReg$(_c, \"ShopPage\");","map":{"version":3,"names":["React","useState","useEffect","paginate","api","_","ItemCard","Pagination","CategoriesList","SortButton","useDispatch","useSelector","getItems","ShopPage","dispatch","currentPage","setCurrentPage","categories","setCategories","searchQuery","setSearchQuery","selectedCategory","setSelectedCategory","sortBy","setSortBy","pageSize","items","setItems","loadItemsList","itemsData","console","log","fetchAll","then","data","handleCategorySelect","item","handleSearchQuery","target","undefined","value","handlePageChange","pageIndex","handleSort","filteredItems","filter","name","toLowerCase","indexOf","JSON","stringify","category","count","length","sortedUsers","orderBy","usersCrop","clearFilter","map"],"sources":["/Users/dariabrusnitsina/Yandex.Disk.localized/Programming/Projects/react-e-commerce/client/src/components/shopPages/shopPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { paginate } from \"../../utils/paginate\"\nimport api from \"../../api\";\nimport _ from \"lodash\";\nimport ItemCard from \"./itemCard\";\nimport Pagination from \"./pagination\";\nimport CategoriesList from \"./categoriesList\";\nimport SortButton from \"./sortButton\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {getItems} from \"../../store/items\";\n\nconst ShopPage = () => {\n    const dispatch = useDispatch();\n    const [currentPage, setCurrentPage] = useState(1);\n    const [categories, setCategories] = useState();\n    const [searchQuery, setSearchQuery] = useState(\"\");\n    const [selectedCategory, setSelectedCategory] = useState();\n    const [sortBy, setSortBy] = useState(\"asc\");\n    const pageSize = 6;\n    const [items, setItems] = useState();\n\n    useEffect(() => {\n        dispatch(loadItemsList());\n    }, []);\n\n\n    const itemsData = useSelector(getItems());\n    console.log(itemsData)\n\n\n    useEffect(() => {\n        api.items.fetchAll().then((data) => setItems(data));\n    }, []);\n\n    useEffect(() => {\n        api.categories.fetchAll().then((data) => setCategories(data));\n    }, []);\n\n    useEffect(() => {\n        setCurrentPage(1);\n    }, [selectedCategory, searchQuery]);\n\n    const handleCategorySelect = (item) => {\n        if (searchQuery !== \"\") setSearchQuery(\"\");\n        setSelectedCategory(item);\n    };\n    const handleSearchQuery = ({ target }) => {\n        setSelectedCategory(undefined);\n        setSearchQuery(target.value);\n    };\n\n    const handlePageChange = (pageIndex) => {\n        setCurrentPage(pageIndex);\n    };\n    const handleSort = (item) => {\n        setSortBy(item);\n    };\n\n    if (items) {\n        const filteredItems = searchQuery\n            ? items.filter(\n                (item) =>\n                    item.name\n                        .toLowerCase()\n                        .indexOf(searchQuery.toLowerCase()) !== -1\n            )\n            : selectedCategory\n                ? items.filter(\n                    (item) =>\n                        JSON.stringify(item.category.name) ===\n                        JSON.stringify(selectedCategory.name)\n                )\n                : items;\n\n        const count = filteredItems.length;\n        const sortedUsers = _.orderBy(\n            filteredItems,\n            ['price'],\n            sortBy\n        );\n\n        const usersCrop = paginate(sortedUsers, currentPage, pageSize);\n        const clearFilter = () => {\n            setSelectedCategory();\n        };\n\n        return (\n            <div className=\"shop__section\">\n                {categories && (\n                    <div>\n                        <div className=\"shop__categories\">\n                            <CategoriesList\n                                selectedItem={selectedCategory}\n                                items={categories}\n                                onItemSelect={handleCategorySelect}\n                            />\n                            <button\n                                className=\"reset-categories-btn\"\n                                onClick={clearFilter}\n                            >\n                                {\" \"}\n                                reset filter\n                            </button>\n                        </div>\n                    </div>\n                )}\n                <div className=\"shop__items\">\n                    <div className=\"shop__items--bar\">\n                        <input\n                            className=\"search-input\"\n                            type=\"text\"\n                            name=\"searchQuery\"\n                            placeholder=\"Search...\"\n                            onChange={handleSearchQuery}\n                            value={searchQuery}\n                        />\n                        <SortButton onSort={handleSort} selectedSort={sortBy}/>\n                    </div>\n\n                    <div className=\"shop__items--list\">\n                        {count > 0 &&\n                            usersCrop.map((item) => (\n                                <ItemCard item={item} width={270}/>\n                            ))\n                        }\n                    </div>\n\n                    <div className=\"d-flex justify-content-center\">\n                        <Pagination\n                            itemsCount={count}\n                            pageSize={pageSize}\n                            currentPage={currentPage}\n                            onPageChange={handlePageChange}\n                        />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n    return <p className=\"loading\">loading...</p>;\n};\n\nexport default ShopPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}